<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OpenAI Response Viewer</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>BETA AI EZ4</h1>

    <div class="container">
      <div class="description">
        <h2>Cari Materi Dari AI</h2>
        <form id="metaForm">
          <label for="title">Title:</label>
          <input type="text" id="title" name="title" required />
          <button type="button" onclick="generateMeta()">Generate AI</button>
        </form>
        <div id="metaResponse"></div>
      </div>

      <div class="tags">
        <div id="imageResponse"></div>
      </div>
    </div>

    <script>
      async function generateMeta() {
        const title = document.getElementById("title").value;
        const metaResponseDiv = document.getElementById("metaResponse");

        try {
          // Show loading message
          metaResponseDiv.innerHTML = "Loading...";

          const response = await fetch(
            "https://ai-4h8z.vercel.app/openai/meta",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ title }),
            }
          );

          const result = await response.json();
          const descriptionText = result.description
            ? result.description.content
            : "No description available";

          metaResponseDiv.innerHTML = `<p>Description: ${descriptionText}</p>`;
        } catch (error) {
          console.error("Error generating meta data:", error);
          metaResponseDiv.innerHTML = "Error generating meta data";
        }
      }

      async function generateImage() {
        const prompt = document.getElementById("imagePrompt").value;
        const imageResponseDiv = document.getElementById("imageResponse");

        try {
          // Show loading message
          imageResponseDiv.innerHTML = "Loading...";

          const response = await fetch("http://localhost:4000/openai/image", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ prompt }),
          });

          const result = await response.json();

          if (
            result.image &&
            Array.isArray(result.image) &&
            result.image.length > 0
          ) {
            const imageResponse = result.image
              .map(
                (image) => `
                            <div>
                                <img src="${image.url}" alt="${image.revised_prompt}" style="width: 512px; height: 512px;">
                                <p>${image.revised_prompt}</p>
                            </div>`
              )
              .join("");
            imageResponseDiv.innerHTML = imageResponse;
          } else {
            imageResponseDiv.innerHTML = "No image available";
          }
        } catch (error) {
          console.error("Error fetching image:", error);
          imageResponseDiv.innerHTML = "Error fetching image";
        }
      }
    </script>
  </body>
</html>
